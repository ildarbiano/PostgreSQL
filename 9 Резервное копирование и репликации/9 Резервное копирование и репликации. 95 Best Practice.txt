=============================== Лучшие практики резервного копирования:
1/	Backup должен быть всегда;
2/	Backup должен быть автоматическим (по расписанию), чтобы не зпаисить от DBA-ответственный за резервное копирование;
3/	Востановление из backup — это крайняя мера, поэтому HOT-backup=Физическая репликация;
4/	Backup нужно хранить отдельно от данных и минимум 2 недели;
5/	Backup нужно регулярно проверять на возможность восстановиться из него, например: посмотреть количество записей по таблицам;
6/	Полезно дублировать backup на удаленную площадку (Data Center);
7/	Backup – это нагрузка на работающую систему, поэтому, ! нужно делать с реплики.
типичные ошибки при бэкапе баз данных 	https://habr.com/ru/post/267881/
------------------------------- ГОРЯЧИЙ РЕЗЕРВ FOR "HA" High Availbility:
*-СИНХРОННАЯ репликация		-реплика должна максимально соответствовать master;
*-запросы к реплике возможны, но не приоритетны.
WAL_sender - WAL_receiver
Параметры:
wal_level = replica		-уровень журнала;
synchronous_commit = on		-включён синхронный commit;
synchronous_standby_names	-должно быть задано имя реплики;
hot_standby_feedback = off 	-не сообщаем о транзакциях мастеру, не мещаем работать master;
max_standby_streaming_delay=t 	-время отметы конфликтных транзакций. 't'-небольшое время отмены транзакции.
https://postgrespro.ru/docs/postgresql/14/runtime-config-replication 
------------------------------- БАЛАНСИРОВКА OLTP нагрузки:
Online Transaction Processing	-это онлайн-обработка транзакций. Такие системы предназначены для обработки большого количества коротких транзакций в реальном времени. Они оптимизированы для CRUD-операций (Create, Read, Update, Delete). Примеры OLTP: интернет-магазины, CRM, SaaS, микросервисы и т. д.. 
*-много коротких запросов:
	*-запросы на реплике должны отрабатываться;
	*-долгие запросы повлияют на мастер, но у нас их не должно быть.
WAL_sender - WAL_receiver
Параметры:
synchronous_commit = off	-выключён синхронный commit;
hot_standby_feedback = on	-сообщаем о транзакциях master-cluster;
max_standby_streaming_delay=T	-время отметы конфликтных транзакций. "T"-по-больше время отмены транзакции.
https://postgrespro.ru/docs/postgresql/14/runtime-config-replication 
------------------------------- РЕПЛИКА ДЛЯ ОТЧЕТОВ, OLAP нагрузки:
Online Analytical Processing	-это технология аналитической обработки данных, которая позволяет быстро обрабатывать сложные многомерные запросы. В основе OLAP — концепция OLAP-куба — многомерной структуры данных, оптимизированной для аналитической обработки. В отличие от традиционных реляционных таблиц, OLAP-кубы организуют данные по измерениям (dimensions) и метрикам (measures), что позволяет мгновенно получать агрегированные значения по различным срезам информации. 
*-Запросы на реплике должны отрабатывать, в том числе и долгие. Самые актуальные данные не нужны;
*-master-cluster не должен испытывать от этого неудобства;
*-Можно совсем развязать сервера и использовать архивы не занимая слов репликации.
WAL_sender - WAL_receiver
Параметры:
synchronous_commit = off	-выключён синхронный commit;
hot_standby_feedback = off	-не сообщаем о транзакциях мастеру, не мешаем работать master-cluster;
max_standby_streaming_delay=-1	-время отметы конфликтных транзакций. "-1"-отключение времени ожидания транзакции, потому как транзакция может длиться часасми.
https://postgrespro.ru/docs/postgresql/14/runtime-config-replication 
------------------------------- ГОРИЗОНТАЛЬНОЕ МАСШТАБИРОВАНИЕ С  "HA" High Availbility:
СИНХРОННАЯ реплика		-одна, для отказоустойчивости. Реплика максимально соответствует master-cluster;
АСИНХРОННЫЕ реплики		-столько, сколько нужно. Для запросов всех видов и типов.
WAL_sender - WAL_receiver
------------------------------- КАСКАДНАЯ РЕПЛИКАЦИЯ:
Чтобы не нагружать основной сервер.
1/	Релика_А с основного сервера;
2/	Реплика_В с Реплики_А.
WAL_sender - WAL_receiver
------------------------------- TIME MACHINE паттерн:
recovery_min_apply_delay 	-в recovery.conf - задержка времени на час.
WAL_sender - WAL_receiver 	-принимаются с задержкой в час.
Появляется время на реакцию, так как DROP Data base в master-cluster не скажется на реплике.
------------------------------- ОБЪЕДИНЕНИЕ ДАННЫХ в логической репликации:
logical replication.worker - WAL_sender регионального сервера А
logical replication.worker - WAL_sender регионального сервера В
logical replication.worker	-центральная База Данных куда сливаются данные регионального сервера А и регионального сервера В.
------------------------------- РАССЫЛКА СПРАВОЧНИКОВ в логической репликации:
WAL_sender - logical replication.worker регионального сервера А
WAL_sender - logical replication.worker регионального сервера В
WAL_sender			-изменения в центральной Базе Данных. Региональные сервера А и В подписаны на изменения центральной БД.
------------------------------- ПРИМЕР организации MAIL.RU:
master
	slave_1
	slave_2-backup
	slave_3
	slave_4
	slave_5
