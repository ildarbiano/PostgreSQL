=================== WAL - журналы:
WRITE AHEAD LOG -  журнал предзаписи. Это механизм, который обеспечивает долговечность и восстанавливаемость данных после сбоя. Механизм сохранения данных раньше, чем данные запишутся на диск HDD. Механизм позволяет восстановиться после сбоя. Принцип работы:
	-При изменении данных PostgreSQL формирует специальную запись в памяти — WAL-запись, данные записываются в журналы. Запись в журнале содержит всю необходимую информацию: тип операции, идентификатор транзакции, номер блока страницы, старые и новые значения; 
	-Запись попадает в специальный буфер в оперативной памяти — WAL buffer; 
	-По-умолчанию, при завершении успешной транзакции (COMMIT), происходит принудительная запись всех соответствующих WAL-записей на постоянное хранилище HDD — этот момент называется checkpoint; 
	-В случае сбоя записи данных в БД, процедура восстановления ищет последнюю запись контрольной точки, чтобы определить точку в WAL (запись REDO), от которой процедура должна начать операцию воспроизведения изменений из WAL-file. Любые изменения файлов данных до этой точки уже гарантированно находятся на диске. 

=================== LSN:
Log Sequence Number в PostgreSQL
уникальный идентификатор позиции в журнале предзаписи (WAL — Write-Ahead Logging). Это 64-битное число, которое представляет собой байтовое смещение до записи относительно начала журнала. LSN выводится в виде двух шестнадцатеричных чисел до 8 цифр каждое через косую черту, например: 16/B374D848. Размер одного LSN — 8 байт, что обеспечивает практически неограниченный диапазон значений для отслеживания изменений. Принцип работы:
	-Когда происходит изменение данных в PostgreSQL, система сначала записывает информацию об этом изменении в журнал WAL, присваивая ему уникальный LSN. Только после этого изменение применяется к основным данным. 
	-Система LSN работает по принципу возрастающей последовательности, где каждое новое значение больше предыдущего. Это позволяет PostgreSQL точно определять состояние базы данных в любой момент времени. 
	-Механизм LSN особенно важен при восстановлении после сбоев, репликации данных и выполнении точечных бэкапов. 


=================== XACT "xact" в PostgreSQL:
структура, которая содержит информацию о статусах транзакций. До версии PostgreSQL 10 она называлась CLOG (commit log). В XACT для каждой транзакции отведено по два бита: по одному на каждый статус. Статус может иметь следующие значения: 
			транзакция стартовала, 
			транзакция успешно завершена, 
			транзакция отменена, 
			подтранзакция успешно завершена. 
-------------------------- Принцип работы:
Информация в структуру XACT записывается в общей памяти. Это массив, который хранится в страницах размером по 8 КБ и содержит номер транзакции и её статус. Некоторые особенности работы:
	При фиксации транзакции в XACT выставляется бит 	committed для этой транзакции.
	При отмене транзакции в XACT выставляется бит 		aborted.
	Статус вложенных транзакций записывается обычным образом в XACT, но финальный статус зависит от статуса основной транзакции: если она отменена, то отменяются также и все вложенные транзакции.
 

Почему биты не устанавливаются самой транзакцией, выполняющей вставку: когда происходит вставка, транзакция ещё не знает, завершится ли она успешно, а в момент фиксации уже непонятно, какие именно строки в каких именно страницах были изменены. 
-------------------------- Хранение:
Данные XACT хранятся в каталоге PGDATA/pg_xact. Файлы в директории pg_xact именуются от 0000 до FFFF, максимальный размер такого файла — 256 КБ. 
В момент запуска PostgreSQL считывает информацию из этих файлов в структуру XACT в общей разделяемой памяти. 

