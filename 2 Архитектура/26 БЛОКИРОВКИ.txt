======================= как получить доступ к одному Объектов/Ресурсов, для изменений, во множестве транзакций?
Процесс начинает работу с Объектом/Ресурсом, установив его блокировку. Блокировка, занятого Ресурса/Объекта одним из процессов, - для других процессов, поэтому возникают очереди. Работа с очередями решается:
		-Multiversion Concurrency Control;
		-Оптимистические блокировки в PostgreSQL — это стратегия блокировки, основанная на предположении, что конфликты случаются редко. Вместо того чтобы сразу блокировать данные, система разрешает свободный доступ и проверяет, не изменились ли данные, только в момент сохранения.

---------------------- Ресурсы/Объекты:
Объекты:
	таблицы (отношения);
	индексы;
	последовательности;
	материализованные представления;
	страницы данных (идентифицируются именем файла и позицией внутри файла);
	табличные строки (страница и смещение внутри страницы).
Ресурсы:
	идентифицируемые заранее присвоенным номером:
		хэш-таблицы,
		буферы,
	абстрактные ресурсы, не имеющие физического смысла:
		идентифицируются просто уникальным числом

====================== Блокировки:
---------------------- Гранулярность блокировки в PostgreSQL:
степень детализации блокировки, то, какой объём данных «захватывается» при блокировании. Гранулярность важна, если ресурсы образуют иерархию, например, таблица состоит из страниц, которые содержат версии строк. Чем выше гранулярность, тем больше возможностей для распараллеливания, но это приводит к увеличению числа блокировок, информацию о которых надо где-то хранить. В PostgreSQL используются блокировки на разных уровнях гранулярности: 
	На уровне ТАБЛИЦ 			—блокируют всю таблицу. Если транзакция A начала изменение таблицы, транзакция B вынуждена ждать завершения A, даже если они затрагивают разные строки. 
	На уровне СТРОК 			—блокируют конкретные строки, затрагиваемые операцией (UPDATE/DELETE/SELECT … FOR UPDATE), вместо всей таблицы. Это позволяет разным транзакциям одновременно изменять разные строки в одной таблице без конфликтов. 
	На уровне СТРАНИЦ 			—исключительные и разделяемые блокировки используются для управления доступом к страницам таблиц в общем пуле буферов. Эти блокировки снимаются немедленно после выборки или обновления строки.

---------------------- Виды блокировок:
EXCLUSIVE
SHARED			на доли секунд в shared buffers и ДБ;
ДОЛГОВРЕМЕННЫЕ		до конца транзакции в shared memory.
*-матрица совместимости в презентации.
		
1/	блокировки ОТНОШЕНИЙ операций
2/	блокировки СТРОК на диске
*-матрица совместимости в презентации.	
3/ 	блокировки ПАМЯТИ: 
			SPINLOCK не имеют мониторинга.
			LIGHTWEIGHTLOCK, случайный процесс
			BUFFERPIN

---------------------- deadlock:
ситуация, когда две или более транзакции ожидают освобождения ресурсов, заблокированных друг другом. Это создаёт циклическую зависимость, которую ни одна из транзакций не может разрешить самостоятельно. Когда несколько ПРОЦЕССОВ находятся в бесконечном ожидании ресурсов, захваченных самим этими ПРОЦЕССАМИ. Причины:
Неправильный порядок блокировок. 		транзакции блокируют строки в разных порядках, что создаёт циклическую зависимость; 
Длинные транзакции 				они удерживают блокировки на длительный период; 
Высокая конкурентность				многие одновременные транзакции увеличивают вероятность конфликтов блокировок; 
Ограничения на внешние ключи			операции, которые вызывают каскадные обновления или удаления.
Postgres строит граф связей. Обнаружив deadlock, Postgres разрывает взаимозависимости.