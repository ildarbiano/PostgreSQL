============================== Роли и атрибуты:
Нет разделения на РОЛЬ, ГРУППА, ПОЛЬЗОВАТЕЛЬ - это одна сущность.
РОЛЬ создавшая объект является его Владельцем.
Пользователь СУБД никак не связан с пользователем ОС, кроме права входа через UNIX socket.
peer Auth через Unix socket	- для первоначального входа и настройки, далее через TCP/IP соединение.
Unix socket (сокет) 		— это программное устройство, которое обеспечивает двунаправленный обмен данными между процессами в операционной системе Unix. 
socket/разъём			— это конечная точка коммуникации, через которую данные поступают в/из процесса. Программный интерфейс сокетов описан в стандарте POSIX.1 и в той или иной мере поддерживается всеми современными операционными системами. 
socket/разъём 			- используются для межпроцессного взаимодействия (IPC) — обмена данными между процессами на одном компьютере. Например: 
	Веб-серверы 			— помогают общаться с браузерами, обслуживать веб-страницы и обрабатывать запросы клиентов.
	Инструменты для networking 	— используются для отправки и приёма сетевых пакетов, диагностики подключения и диагностики сети.
	Контейнерные приложения 	— применяются для внутренней коммуникации между процессами в контейнерах и для взаимодействия с системой хоста.
В Unix есть два вида сокетов: 
Сетевые 			— обеспечивают взаимодействие для процессов, которые могут быть запущены на разных хостах, с помощью протоколов, например TCP/IP. 
UNIX domain socket, UDS		— обеспечивают связь между процессами в одной системе, не используя сетевой протокол для взаимодействия. Используют файловую систему как адресное пространство имён, то есть представляются процессами как специальные файлы в файловой системе.

------------------------------- СОЗДАНИЕ ПОЛЬЗОВАТЕЛЯ И ЕГО АТРИБУТЫ:
CREATE ROLE	роль {name} [WITH] атрибут [атрибут ...]
LOGIN 		возможность подключения
SUPERUSER 	суперпользователь, может управлять люьрй ролью и другими SUPERUSER
CREATEDB 	возможность создавать базы данных
CREATE ROLE 	возможность создавать роли [WITH] [атрибут], кроме суперпользовательской
REPLICATION 	использование протокола репликации
-- атрибуты:
NOLOGIN
NOCREATEDB
https://postgrespro.ru/docs/postgresql/14/sql-createrole 

------------------------------- МОДЕЛИ организации доступа. Ролевая модель #1:
Для каждого реального пользователя создавать соответствующего users в Postgres
Плюсы +: 	четко определяем права каждому пользователю
Минусы -: 	очень громоздкая инфраструктура, потеря производительности
'роль1': GRANT 'группа' TO 'роль2' WITH ADMIN OPTION;				- Включение/GRANT в группу с передачей права управления
'роль2': GRANT 'группа' TO 'роль3' WITH ADMIN OPTION;				- Теперь 'роль2' управляет группой, включая передачу права управления
'роль2': GRANT 'группа' TO 'роль4' WITH ADMIN OPTION;				- Теперь 'роль2' управляет группой, включая передачу права управления
'роль1': GRANT {привилегии} ON {объект} TO 'роль2' WITH GRANT OPTION;		- Выдача привилегии с правом передач
-----------------------
'роль1': REVOKE ADMIN OPTION FOR 'группа' FROM 'роль2';				- Отзыв/REVOKE права передачи управления.
'роль1': REVOKE GRANT OPTION FOR {привилегии} ON {объект} FROM 'роль2' CASCADE;	- Отзыв/REVOKE, каскадная - включая тех кому они выдали права.
'роль1': REVOKE {привилегии} ON {объект} FROM 'роль2' CASCADE;			- Отзыв/REVOKE, каскадная - включая тех кому они выдали права.


https://postgrespro.ru/docs/postgresql/14/sql-revoke 


------------------------------- МОДЕЛИ организации доступа. Ролевая модель #2:
создать таблицу с правами и привелегиями и проверяем их на уровне backend. Создать отдельную таблицу с пользователями, паролями и правами доступа и проверять доступ к тем или иных функциям уже на стороне приложения.
Плюсы +: 	легковесность и гибкость настройки, нет потери производительности
Минусы -: 	необходимо инфраструктуру прораюатывать на стороне приложения учитывать, фактор ролевого доступа


------------------------------- МОДЕЛИ организации доступа. Ролевая модель #3:
На хранимых процедурах. Выдаём права на хранимые процедуры. Позволяет определённым пользователям или группам выполнять процедуру, а также изменять и удалять её. Для доступа к хранимым процедурам в PostgreSQL используется привилегия EXECUTE. Она разрешает вызывать процедуру, в том числе использовать любые операторы, реализованные данной процедурой. 
GRANT EXECUTE ON {procedure name} TO {user name}
Плюсы +: 	абстрагируемся от физической реализации, от JOIN, от того как таблицы связаны друг с другом. Только имя хранимой процедуры;
Минусы -: 	сложность реализации


=============================== ПРИВИЛЕГИИ:
Набор действий:SELECT, INSERT, UPDATE, DELETE, TRUNCATE, CREATE, CONNECT, EXECUTE, которые пользователь может совершать с объектами БД, такими как: table, data base, schema, index, sequence, view, function

https://postgrespro.ru/docs/postgresql/14/sql-grant 

SUPERUSER	полный доступ ко всем объектам — проверки не выполняются, за исключением прав на вызов ХП (security definer/security invoker)
		SECURITY DEFINER (безопасность определившего)	показывает, что функция выполняется с правами пользователя, владеющего ей. 
		SECURITY INVOKER (безопасность вызывающего)	показывает, что функция выполняется с правами пользователя, вызвавшего её (На вызов хранимых процедур). 
USER		доступ в рамках выданных привилегий (изначально получает полный набор), а также действия не регламентируемые привилегиями, например: удаление, выдача и отзыв привилегий и т. п.
ANOTHER		доступ исключительно в рамках выданных привилегий, за исключением default прав на схему public.

GRANT SELECT ON mytable TO PUBLIC;						-выдать права на таблицу "mytable" групповой роли PUBLIC для действия: SELECT
GRANT SELECT, UPDATE, INSERT ON mytable TO admin;				-выдать права на таблицу "mytable" пользователю admin для действий: SELECT, UPDATE, INSERT
GRANT SELECT (col1), UPDATE (col1) ON mytable TO miriam_rw;			-выдать права на колонку (col1) таблицы "mytable"


------------------------------- ВИД Привелегий:
\dp mytable    ----> miriam=arwdDxt
имя_роли=xxxx -- права, назначенные роли
        =xxxx -- права, назначенные PUBLIC
         	r -- SELECT ("read", чтение)
           	w -- UPDATE ("write", запись)
            	a -- INSERT ("append", добавление)
            	d -- DELETE
            	D -- TRUNCATE
            	x -- REFERENCES
            	t -- TRIGGER
            	X -- EXECUTE
            	U -- USAGE
            	C -- CREATE
            	c -- CONNECT
            	T -- TEMPORARY
arwdDxt -- ALL PRIVILEGES (все права для таблиц; для других объектов другие)
* 	-- право передачи заданного права        
/yyyy 	-- роль, назначившая это право

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Права в схеме 'public' лучше к пользователей забирать, потому как 
default права на эту схему есть у всех и, все могут создавать там таблицы и управлять ими. 
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!





